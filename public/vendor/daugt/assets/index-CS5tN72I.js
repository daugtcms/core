const P=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,O=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,j=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function $(e,o){if(e==="__proto__"||e==="constructor"&&o&&typeof o=="object"&&"prototype"in o){L(e);return}return o}function L(e){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`)}function I(e,o={}){if(typeof e!="string")return e;const t=e.trim();if(e[0]==='"'&&e.endsWith('"')&&!e.includes("\\"))return t.slice(1,-1);if(t.length<=9){const s=t.toLowerCase();if(s==="true")return!0;if(s==="false")return!1;if(s==="undefined")return;if(s==="null")return null;if(s==="nan")return Number.NaN;if(s==="infinity")return Number.POSITIVE_INFINITY;if(s==="-infinity")return Number.NEGATIVE_INFINITY}if(!j.test(e)){if(o.strict)throw new SyntaxError("[destr] Invalid JSON");return e}try{if(P.test(e)||O.test(e)){if(o.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(e,$)}return JSON.parse(e)}catch(s){if(o.strict)throw s;return e}}const F=/#/g,q=/&/g,U=/\//g,Q=/=/g,g=/\+/g,D=/%5e/gi,J=/%60/gi,H=/%7c/gi,B=/%20/gi;function M(e){return encodeURI(""+e).replace(H,"|")}function w(e){return M(typeof e=="string"?e:JSON.stringify(e)).replace(g,"%2B").replace(B,"+").replace(F,"%23").replace(q,"%26").replace(J,"`").replace(D,"^").replace(U,"%2F")}function b(e){return w(e).replace(Q,"%3D")}function _(e=""){try{return decodeURIComponent(""+e)}catch{return""+e}}function G(e){return _(e.replace(g," "))}function K(e){return _(e.replace(g," "))}function W(e=""){const o={};e[0]==="?"&&(e=e.slice(1));for(const t of e.split("&")){const s=t.match(/([^=]+)=?(.*)/)||[];if(s.length<2)continue;const i=G(s[1]);if(i==="__proto__"||i==="constructor")continue;const a=K(s[2]||"");o[i]===void 0?o[i]=a:Array.isArray(o[i])?o[i].push(a):o[i]=[o[i],a]}return o}function V(e,o){return(typeof o=="number"||typeof o=="boolean")&&(o=String(o)),o?Array.isArray(o)?o.map(t=>`${b(e)}=${w(t)}`).join("&"):`${b(e)}=${w(o)}`:b(e)}function k(e){return Object.keys(e).filter(o=>e[o]!==void 0).map(o=>V(o,e[o])).filter(Boolean).join("&")}const z=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,X=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,Y=/^([/\\]\s*){2,}[^/\\]/,Z=/^\.?\//;function A(e,o={}){return typeof o=="boolean"&&(o={acceptRelative:o}),o.strict?z.test(e):X.test(e)||(o.acceptRelative?Y.test(e):!1)}function v(e="",o){return e.endsWith("/")}function x(e="",o){return(v(e)?e.slice(0,-1):e)||"/"}function ee(e="",o){return e.endsWith("/")?e:e+"/"}function oe(e,o){if(te(o)||A(e))return e;const t=x(o);return e.startsWith(t)?e:ne(t,e)}function re(e,o){const t=ie(e),s={...W(t.search),...o};return t.search=k(s),ae(t)}function te(e){return!e||e==="/"}function se(e){return e&&e!=="/"}function ne(e,...o){let t=e||"";for(const s of o.filter(i=>se(i)))if(t){const i=s.replace(Z,"");t=ee(t)+i}else t=s;return t}const S=Symbol.for("ufo:protocolRelative");function ie(e="",o){const t=e.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(t){const[,f,h=""]=t;return{protocol:f.toLowerCase(),pathname:h,href:f+h,auth:"",host:"",search:"",hash:""}}if(!A(e,{acceptRelative:!0}))return R(e);const[,s="",i,a=""]=e.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[];let[,u="",n=""]=a.match(/([^#/?]*)(.*)?/)||[];s==="file:"&&(n=n.replace(/\/(?=[A-Za-z]:)/,""));const{pathname:c,search:p,hash:r}=R(n);return{protocol:s.toLowerCase(),auth:i?i.slice(0,Math.max(0,i.length-1)):"",host:u,pathname:c,search:p,hash:r,[S]:!s}}function R(e=""){const[o="",t="",s=""]=(e.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:o,search:t,hash:s}}function ae(e){const o=e.pathname||"",t=e.search?(e.search.startsWith("?")?"":"?")+e.search:"",s=e.hash||"",i=e.auth?e.auth+"@":"",a=e.host||"";return(e.protocol||e[S]?(e.protocol||"")+"//":"")+i+a+o+t+s}class ce extends Error{constructor(o,t){super(o,t),this.name="FetchError",t!=null&&t.cause&&!this.cause&&(this.cause=t.cause)}}function fe(e){var c,p,r,f,h;const o=((c=e.error)==null?void 0:c.message)||((p=e.error)==null?void 0:p.toString())||"",t=((r=e.request)==null?void 0:r.method)||((f=e.options)==null?void 0:f.method)||"GET",s=((h=e.request)==null?void 0:h.url)||String(e.request)||"/",i=`[${t}] ${JSON.stringify(s)}`,a=e.response?`${e.response.status} ${e.response.statusText}`:"<no response>",u=`${i}: ${a}${o?` ${o}`:""}`,n=new ce(u,e.error?{cause:e.error}:void 0);for(const y of["request","options","response"])Object.defineProperty(n,y,{get(){return e[y]}});for(const[y,l]of[["data","_data"],["status","status"],["statusCode","status"],["statusText","statusText"],["statusMessage","statusText"]])Object.defineProperty(n,y,{get(){return e.response&&e.response[l]}});return n}const pe=new Set(Object.freeze(["PATCH","POST","PUT","DELETE"]));function T(e="GET"){return pe.has(e.toUpperCase())}function ue(e){if(e===void 0)return!1;const o=typeof e;return o==="string"||o==="number"||o==="boolean"||o===null?!0:o!=="object"?!1:Array.isArray(e)?!0:e.buffer?!1:e.constructor&&e.constructor.name==="Object"||typeof e.toJSON=="function"}const he=new Set(["image/svg","application/xml","application/xhtml","application/html"]),ye=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function le(e=""){if(!e)return"json";const o=e.split(";").shift()||"";return ye.test(o)?"json":he.has(o)||o.startsWith("text/")?"text":"blob"}function de(e,o,t,s){const i=me((o==null?void 0:o.headers)??(e==null?void 0:e.headers),t==null?void 0:t.headers,s);let a;return(t!=null&&t.query||t!=null&&t.params||o!=null&&o.params||o!=null&&o.query)&&(a={...t==null?void 0:t.params,...t==null?void 0:t.query,...o==null?void 0:o.params,...o==null?void 0:o.query}),{...t,...o,query:a,params:a,headers:i}}function me(e,o,t){if(!o)return new t(e);const s=new t(o);if(e)for(const[i,a]of Symbol.iterator in e||Array.isArray(e)?e:new t(e))s.set(i,a);return s}async function m(e,o){if(o)if(Array.isArray(o))for(const t of o)await t(e);else await o(e)}const Ee=new Set([408,409,425,429,500,502,503,504]),be=new Set([101,204,205,304]);function C(e={}){const{fetch:o=globalThis.fetch,Headers:t=globalThis.Headers,AbortController:s=globalThis.AbortController}=e;async function i(n){const c=n.error&&n.error.name==="AbortError"&&!n.options.timeout||!1;if(n.options.retry!==!1&&!c){let r;typeof n.options.retry=="number"?r=n.options.retry:r=T(n.options.method)?0:1;const f=n.response&&n.response.status||500;if(r>0&&(Array.isArray(n.options.retryStatusCodes)?n.options.retryStatusCodes.includes(f):Ee.has(f))){const h=typeof n.options.retryDelay=="function"?n.options.retryDelay(n):n.options.retryDelay||0;return h>0&&await new Promise(y=>setTimeout(y,h)),a(n.request,{...n.options,retry:r-1})}}const p=fe(n);throw Error.captureStackTrace&&Error.captureStackTrace(p,a),p}const a=async function(c,p={}){var y;const r={request:c,options:de(c,p,e.defaults,t),response:void 0,error:void 0};r.options.method=(y=r.options.method)==null?void 0:y.toUpperCase(),r.options.onRequest&&await m(r,r.options.onRequest),typeof r.request=="string"&&(r.options.baseURL&&(r.request=oe(r.request,r.options.baseURL)),r.options.query&&(r.request=re(r.request,r.options.query))),r.options.body&&T(r.options.method)&&(ue(r.options.body)?(r.options.body=typeof r.options.body=="string"?r.options.body:JSON.stringify(r.options.body),r.options.headers=new t(r.options.headers||{}),r.options.headers.has("content-type")||r.options.headers.set("content-type","application/json"),r.options.headers.has("accept")||r.options.headers.set("accept","application/json")):("pipeTo"in r.options.body&&typeof r.options.body.pipeTo=="function"||typeof r.options.body.pipe=="function")&&("duplex"in r.options||(r.options.duplex="half")));let f;if(!r.options.signal&&r.options.timeout){const l=new s;f=setTimeout(()=>{const d=new Error("[TimeoutError]: The operation was aborted due to timeout");d.name="TimeoutError",d.code=23,l.abort(d)},r.options.timeout),r.options.signal=l.signal}try{r.response=await o(r.request,r.options)}catch(l){return r.error=l,r.options.onRequestError&&await m(r,r.options.onRequestError),await i(r)}finally{f&&clearTimeout(f)}if(r.response.body&&!be.has(r.response.status)&&r.options.method!=="HEAD"){const l=(r.options.parseResponse?"json":r.options.responseType)||le(r.response.headers.get("content-type")||"");switch(l){case"json":{const d=await r.response.text(),N=r.options.parseResponse||I;r.response._data=N(d);break}case"stream":{r.response._data=r.response.body;break}default:r.response._data=await r.response[l]()}}return r.options.onResponse&&await m(r,r.options.onResponse),!r.options.ignoreResponseError&&r.response.status>=400&&r.response.status<600?(r.options.onResponseError&&await m(r,r.options.onResponseError),await i(r)):r.response},u=async function(c,p){return(await a(c,p))._data};return u.raw=a,u.native=(...n)=>o(...n),u.create=(n={},c={})=>C({...e,...c,defaults:{...e.defaults,...c.defaults,...n}}),u}const E=function(){if(typeof globalThis<"u")return globalThis;if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}(),we=E.fetch?(...e)=>E.fetch(...e):()=>Promise.reject(new Error("[ofetch] global.fetch is not supported!")),ge=E.Headers,Re=E.AbortController,Te=C({fetch:we,Headers:ge,AbortController:Re}),_e=Te;export{_e as $fetch,Re as AbortController,ce as FetchError,ge as Headers,C as createFetch,fe as createFetchError,we as fetch,Te as ofetch};
